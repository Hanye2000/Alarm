const SHEET_URL =
  "https://opensheet.elk.sh/1_IiaZRi0UJQ6AuTduIM_i3ho0YlSkS5E01yQk7yDWo/Sheet%201";

async function loadMessage() {
  try {
    const res = await fetch(SHEET_URL);
    if (!res.ok) throw new Error("Nie można pobrać danych z arkusza");

    const rows = await res.json();
    if (!rows.length) throw new Error("Brak danych w arkuszu");

    const last = rows[rows.length - 1];

    const statusEl = document.getElementById("status");
    const updatedEl = document.getElementById("updated");

    // Update message text
    statusEl.textContent = last.Message || "Brak wiadomości";

    // Apply CSS class based on type
    const type = last.Type?.toLowerCase();
    if (type === "alert") {
      statusEl.className = "alert";
    } else if (type === "safe") {
      statusEl.className = "safe";
    } else {
      statusEl.className = ""; // default styling for unknown types like "info"
    }

    // Parse European timestamp: dd.mm.yyyy hh:mm:ss
    const [datePart, timePart] = last.Timestamp.split(" ");
    const [day, month, year] = datePart.split(".");
    const formattedDate = new Date(`${year}-${month}-${day}T${timePart}`);
    updatedEl.textContent =
      "Ostatnia aktualizacja: " + formattedDate.toLocaleString("pl-PL");

  } catch (err) {
    console.error(err);
    const statusEl = document.getElementById("status");
    statusEl.textContent = "Błąd ładowania danych";
    statusEl.className = "";
    document.getElementById("updated").textCo
